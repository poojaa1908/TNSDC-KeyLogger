= Table.AddColumn(PreviousStepName, "ExpandedHits", each 
    let
        original = [hits],
        len = List.Count(original),
        padded = 
            if len = 6 then original
            else if len = 5 then original & {null}
            else if len = 4 then original & {null, null}
            else if len = 3 then original & {null, null, null}
            else if len = 2 then original & {null, null, null, null}
            else if len = 1 then original & {null, null, null, null, null}
            else {null, null, null, null, null, null},
        record = Record.FromList(padded, {"hit1", "hit2", "hit3", "hit4", "hit5", "hit6"})
    in
        record
)
    // Step 1: Starting from your original table
    Source = YourPreviousStep, 
    
    // Step 2: Add index to preserve original row
    WithIndex = Table.AddIndexColumn(Source, "RowID", 0, 1, Int64.Type),

    // Step 3: Expand hits list to rows
    ExpandedHits = Table.ExpandListColumn(WithIndex, "BotResponse.hits"),

    // Step 4: Add index per original RowID group to mark hit1, hit2, ...
    Grouped = Table.Group(ExpandedHits, {"RowID"}, {
        {"AllHits", each Table.AddIndexColumn(_, "HitIndex", 1, 1, Int64.Type)}
    }),

    // Step 5: Expand grouped table back
    ExpandedGrouped = Table.ExpandTableColumn(Grouped, "AllHits", {"BotResponse.hits", "RowID", "searchKeyword", "HitIndex"}),

    // Step 6: Pivot so that HitIndex values become column names
    Pivoted = Table.Pivot(ExpandedGrouped, List.Distinct(ExpandedGrouped[HitIndex]), "HitIndex", "BotResponse.hits"),

    // Step 7: Remove duplicate RowID column if needed
    Final = Table.RemoveColumns(Pivoted, {"RowID"})
in
    Final
