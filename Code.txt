
def get_diffs(file1, file2):
    lines1 = read_file_lines(file1)
    lines2 = read_file_lines(file2)

    matcher = difflib.SequenceMatcher(None, lines1, lines2)
    changes = []

    for tag, i1, i2, j1, j2 in matcher.get_opcodes():
        if tag == 'insert':
            for line in lines2[j1:j2]:
                changes.append(('add', line))
        elif tag == 'delete':
            for line in lines1[i1:i2]:
                changes.append(('remove', line))
        elif tag == 'replace':
            # Real change (not just line shift)
            old = lines1[i1:i2]
            new = lines2[j1:j2]
            for line in old:
                changes.append(('remove', line))
            for line in new:
                changes.append(('add', line))
    return changes
