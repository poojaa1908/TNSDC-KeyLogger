CutoffTime =
VAR SelectedValue = SELECTEDVALUE(TimeValue[TimeValue])
VAR SelectedUnit = SELECTEDVALUE(TimeGranularity[Unit])
VAR NowTime = NOW()
RETURN
    SWITCH(
        SelectedUnit,
        "Minutes", NOW() - (SelectedValue / 1440.0),
        "Hours",   NOW() - (SelectedValue / 24.0),
        "Days",    NOW() - SelectedValue,
        "Weeks",   NOW() - (SelectedValue * 7),
        "Months",  EDATE(NOW(), -SelectedValue),
        "Years",   EDATE(NOW(), -12 * SelectedValue),
        NOW()
    )
